#!/bin/bash
# GUรA RรPIDA - Proyecto 3 SOPES
# Carnet: 202200129 | Municipio: Chinautla

clear

echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ                                                                        โ"
echo "โ         ๐ GUรA RรPIDA - SISTEMA DE TWEETS DEL CLIMA ๐ค๏ธ               โ"
echo "โ                                                                        โ"
echo "โ                     Carnet: 202200129 - Chinautla                     โ"
echo "โ                      Universidad USAC - Aรฑo 2025                      โ"
echo "โ                                                                        โ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# Colores
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
MAGENTA='\033[0;35m'
NC='\033[0m'

echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${MAGENTA}PASO 0: VERIFICAR CONEXIรN CON GKE${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo "Ya tienes kubeconfig cargado. Verifica con:"
echo ""
echo "  kubectl get nodes"
echo ""
echo "Deberรญas ver los nodos del cluster: proyecto3-sopes-1"
echo ""

# Verificar conexiรณn
if kubectl get nodes &> /dev/null; then
    echo -e "${GREEN}โ Conexiรณn con cluster verificada${NC}"
else
    echo -e "${YELLOW}โ๏ธ  No hay conexiรณn con el cluster${NC}"
fi

echo ""
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${MAGENTA}PASO 1: DESPLEGAR LA INFRAESTRUCTURA${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo "Primero, actualiza la IP de tu Zot Registry:"
echo ""
echo "  ./update-registry.sh 34.159.50.100:5000"
echo ""
echo "Luego, compila y envรญa las imรกgenes Docker:"
echo ""
echo "  ./build-images.sh 34.159.50.100:5000"
echo ""
echo "Finalmente, despliega todo:"
echo ""
echo "  ./deploy.sh"
echo ""
echo -e "${YELLOW}โฑ๏ธ  Espera 15-20 minutos a que Kafka, RabbitMQ y Valkey estรฉn listos${NC}"
echo ""

echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${MAGENTA}PASO 2: MONITOREAR EL DESPLIEGUE${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo "En otra terminal, monitorea el progreso:"
echo ""
echo "  kubectl get pods -n weather-system -w"
echo ""
echo "Todos deben estar en estado 'Running' o 'Completed'"
echo ""

echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${MAGENTA}PASO 3: EJECUTAR PRUEBAS DE CARGA CON LOCUST${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo "Una vez que todos los pods estรกn corriendo:"
echo ""
echo "  ./run-locust.sh"
echo ""
echo "Elige una opciรณn:"
echo "  1 = Modo Web (Interface grรกfica - RECOMENDADO)"
echo "  4 = Modo Pesado (10,000 tweets automรกticos)"
echo ""

echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${MAGENTA}PASO 4: VISUALIZAR EN GRAFANA${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo "Mientras Locust genera tweets:"
echo ""
echo "  ./run-grafana.sh"
echo ""
echo "Luego accede a Grafana en:"
echo "  http://localhost:3000"
echo ""
echo "Credenciales:"
echo "  Usuario: admin"
echo "  Contraseรฑa: admin123"
echo ""

echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${MAGENTA}PASO 5: VERIFICAR DATOS EN VALKEY${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo "Para ver los contadores en tiempo real:"
echo ""
echo "  ./run-valkey.sh"
echo ""
echo "Elige opciรณn 3 para ver contadores o 1 para acceso interactivo"
echo ""

echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${MAGENTA}OPCIONES RรPIDAS${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo -e "${GREEN}๐ Ver status general:${NC}"
echo "  ./run-tests.sh"
echo ""
echo -e "${GREEN}๐ Ver logs en vivo:${NC}"
echo "  kubectl logs -f deployment/go-deployment-1 -n weather-system"
echo ""
echo -e "${GREEN}๐ Ver HPA escalando:${NC}"
echo "  kubectl get hpa -n weather-system -w"
echo ""
echo -e "${GREEN}๐งน Limpiar todo (eliminar namespace):${NC}"
echo "  ./cleanup.sh"
echo ""

echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${MAGENTA}INFORMACIรN IMPORTANTE${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo -e "${YELLOW}โ๏ธ  NO HAGAS ESTO ANTES DE LA EVALUACIรN:${NC}"
echo "  - No destruyas el cluster (debe estar 24+ horas corriendo)"
echo "  - No vacรญes Valkey antes de capturar pantallazos"
echo ""
echo -e "${YELLOW}๐ ARCHIVOS IMPORTANTES:${NC}"
echo "  - TECNICA.md: Documentaciรณn tรฉcnica completa (70+ pรกginas)"
echo "  - RESUMEN.md: Resumen ejecutivo con checklist"
echo "  - EJEMPLOS.md: Ejemplos de comandos y troubleshooting"
echo "  - README.md: Quick start"
echo ""

echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo -e "${GREEN}โ ยกSistema listo! Comienza con el PASO 0${NC}"
echo ""
